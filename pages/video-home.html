<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>视频首页 - UZIN优成</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <div class="container">
        <!-- 轮播图 -->
        <div class="carousel">
            <div class="carousel-container" id="carousel-container">
                <!-- 轮播图将通过JavaScript动态生成 -->
            </div>
            <div class="carousel-dots" id="carousel-dots">
                <!-- 轮播指示点将通过JavaScript动态生成 -->
            </div>
        </div>

        <!-- 三宫格 -->
        <div class="grid-container grid-3" id="grid-container">
            <!-- 分类将通过JavaScript动态生成 -->
        </div>
    </div>

    <script src="../js/carousel.js"></script>
    <script>
        // 加载JSON数据并生成页面内容
        async function loadData() {
            try {
                const response = await fetch('../data/data.json');
                const data = await response.json();

                // 生成轮播图
                const carouselContainer = document.getElementById('carousel-container');
                const carouselDots = document.getElementById('carousel-dots');

                data.carousels.video.forEach((item, index) => {
                    // 创建轮播图片
                    const slide = document.createElement('div');
                    slide.className = 'carousel-slide';
                    if (index === 0) {
                        slide.innerHTML = `<img src="${item.image}" alt="${item.alt}">`;
                    } else {
                        slide.innerHTML = `<img data-src="${item.image}" alt="${item.alt}" loading="lazy">`;
                    }
                    carouselContainer.appendChild(slide);

                    // 创建指示点
                    const dot = document.createElement('span');
                    dot.className = 'dot';
                    carouselDots.appendChild(dot);
                });

                // 添加左右箭头按钮
                const carousel = document.querySelector('.carousel');
                if (!carousel.querySelector('.carousel-arrow-left')) {
                    const prevBtn = document.createElement('button');
                    prevBtn.className = 'carousel-arrow carousel-arrow-left';
                    prevBtn.setAttribute('aria-label', '上一张');
                    prevBtn.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>`;
                    carousel.appendChild(prevBtn);

                    const nextBtn = document.createElement('button');
                    nextBtn.className = 'carousel-arrow carousel-arrow-right';
                    nextBtn.setAttribute('aria-label', '下一张');
                    nextBtn.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>`;
                    carousel.appendChild(nextBtn);
                }

                // 初始化轮播图
                if (carousel && typeof initCarousel === 'function') {
                    initCarousel(carousel);
                }

                // 生成分类网格
                const gridContainer = document.getElementById('grid-container');
                data.videoCategories.forEach((category, index) => {
                    const gridItem = document.createElement('a');
                    gridItem.href = `video-category.html?category=${encodeURIComponent(category.name)}`;
                    gridItem.className = 'grid-item';
                    gridItem.innerHTML = `
                        <div class="grid-icon-img">
                            <img src="${category.logo}" alt="${category.name}" loading="lazy">
                        </div>
                        <span class="grid-label">${category.name}</span>
                    `;
                    gridContainer.appendChild(gridItem);
                });

            } catch (error) {
                console.error('加载数据失败:', error);
            }
        }

        // 页面加载时执行
        loadData();
    </script>
</body>
</html>
